# StableVault å®Œæ•´æ¼”ç¤ºæµç¨‹æŒ‡å—

æœ¬æ–‡æ¡£æä¾›äº†ä¸€å¥—å®Œæ•´çš„æ¼”ç¤ºè„šæœ¬ï¼Œæ¶µç›–ç¯å¢ƒå¯åŠ¨ã€æ­£å¸¸äº¤äº’ã€æ¨¡æ‹Ÿé£é™©å’Œè‡ªåŠ¨æ¸…ç®—ã€‚

## ğŸ“ ç¬¬ä¸€é˜¶æ®µï¼šä¸€é”®å¯åŠ¨ç¯å¢ƒ

æˆ‘ä»¬å°†ä½¿ç”¨ `scripts/dev_bootstrap.sh` è„šæœ¬æ¥å¯åŠ¨æœ¬åœ°åŒºå—é“¾ã€éƒ¨ç½²åˆçº¦å¹¶è‡ªåŠ¨é…ç½®ç¯å¢ƒå˜é‡ã€‚

### 1. å¯åŠ¨åŒºå—é“¾ä¸éƒ¨ç½²
æ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯ï¼ˆTerminal Aï¼‰ï¼Œè¿è¡Œï¼š
```bash
./scripts/dev_bootstrap.sh
```
*   **æˆåŠŸæ ‡å¿—**ï¼šçœ‹åˆ° `[ok] Done.` ä»¥åŠåˆçº¦åœ°å€åˆ—è¡¨ã€‚
*   **æ³¨æ„**ï¼šè¯·ä¿æŒæ­¤ç»ˆç«¯å¼€å¯ï¼Œä¸è¦å…³é—­ Anvilã€‚

### 2. å¯åŠ¨åç«¯ (Keeper & API)
æ‰“å¼€ç¬¬äºŒä¸ªç»ˆç«¯ï¼ˆTerminal Bï¼‰ï¼š
```bash
cd backend
npm run dev
```
*   **æˆåŠŸæ ‡å¿—**ï¼šçœ‹åˆ° `Server running at http://127.0.0.1:8080` ä»¥åŠ `Keeper worker started`.

### 3. å¯åŠ¨å‰ç«¯ (UI)
æ‰“å¼€ç¬¬ä¸‰ä¸ªç»ˆç«¯ï¼ˆTerminal Cï¼‰ï¼š
```bash
cd frontend
npm run dev
```
*   **æ“ä½œ**ï¼šåœ¨æµè§ˆå™¨æ‰“å¼€ `http://127.0.0.1:5173`ã€‚

---

## ğŸ­ ç¬¬äºŒé˜¶æ®µï¼šç”¨æˆ·äº¤äº’æ¼”ç¤º (Frontend)

**è§’è‰²**ï¼šæ™®é€šç”¨æˆ· (User)

### åœºæ™¯ 1: åˆ›å»º Vault å¹¶é“¸é€  STB
1.  **è¿æ¥é’±åŒ…**: ç‚¹å‡»å³ä¸Šè§’ "Connect Wallet"ã€‚
    *   *æç¤º*: ä½¿ç”¨ MetaMask è¿æ¥åˆ° `Localhost 8545` ç½‘ç»œã€‚
    *   *æç¤º*: å¦‚æœæ˜¯æ–°é’±åŒ…ï¼Œéœ€è¦åœ¨ MetaMask ä¸­å¯¼å…¥ Anvil çš„ç§é’¥ï¼ˆ`0xac09...` å¼€å¤´é‚£ä¸ªï¼Œæˆ–è€… Anvil å¯åŠ¨æ—¶æ‰“å°çš„ç¬¬ä¸€ä¸ªç§é’¥ï¼‰ã€‚
2.  **å­˜å…¥ ETH**:
    *   ç‚¹å‡» "Deposit" æ ‡ç­¾ã€‚
    *   è¾“å…¥ **10** (ETH)ã€‚
    *   ç‚¹å‡» "Deposit"ã€‚
    *   è§‚å¯Ÿ Dashboard: `Collateral` å˜ä¸º 10.00 ETHï¼Œ`Health Factor` ä¸º Safeã€‚
3.  **é“¸é€  STB**:
    *   ç‚¹å‡» "Mint" æ ‡ç­¾ã€‚
    *   è¾“å…¥ **5000** (STB)ã€‚
    *   ç‚¹å‡» "Mint"ã€‚
    *   è§‚å¯Ÿ Dashboard: `Debt` å˜ä¸º 5000.00 STBï¼Œ`Collateral Ratio` çº¦ä¸º 500% (å‡è®¾ ETH=$2500)ã€‚

---

## âš¡ ç¬¬ä¸‰é˜¶æ®µï¼šä¸Šå¸æ¨¡å¼ä¸æ¸…ç®—æ¼”ç¤º (Terminal)

**è§’è‰²**ï¼šç³»ç»Ÿç®¡ç†å‘˜/é»‘å®¢ (Admin)

ä¸ºäº†æ¼”ç¤ºæ¸…ç®—ï¼Œæˆ‘ä»¬éœ€è¦æ¨¡æ‹Ÿ ETH ä»·æ ¼æš´è·Œã€‚ç”±äºæµ‹è¯•ç½‘ä»·æ ¼ä¸å¯æ§ï¼Œæˆ‘ä»¬ä½¿ç”¨**ç®¡ç†å‘˜å‘½ä»¤**å¼ºåˆ¶ä¿®æ”¹é¢„è¨€æœºä»·æ ¼ã€‚

### åœºæ™¯ 2: æ¨¡æ‹Ÿä»·æ ¼å´©ç›˜ (ä¸Šå¸ä¹‹æ‰‹)
åœ¨ç»ˆç«¯ï¼ˆä»»æ„ä¸€ä¸ªç©ºé—²ç»ˆç«¯ï¼‰æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ã€‚è¿™ä¼šè°ƒç”¨ `StableVault` åˆçº¦çš„ `setDemoPrice` å‡½æ•°ã€‚

**1. å¼€å¯ Demo æ¨¡å¼** (å¦‚æœå°šæœªå¼€å¯):
```bash
# è·å–åˆçº¦æ‹¥æœ‰è€…ç§é’¥ (Anvil é»˜è®¤è´¦æˆ· 0)
export PRIVATE_KEY=0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
# ä» backend/.env è·å–åˆçº¦åœ°å€
export RPC_URL=http://127.0.0.1:8545
source_backend_env() {
    set -a
    . backend/.env
    set +a
}
source_backend_env

# å¯ç”¨ Demo Mode
cast send $STABLE_VAULT_ADDRESS "setDemoMode(bool)" true --private-key $PRIVATE_KEY --rpc-url $RPC_URL
```

**2. ç ¸ç›˜ (è®¾ç½® ETH = $700)**:
```bash
# è®¾ç½®ä»·æ ¼ä¸º $700 (18ä½ç²¾åº¦)
cast send $STABLE_VAULT_ADDRESS "setDemoPrice(uint256)" 700000000000000000000 --private-key $PRIVATE_KEY --rpc-url $RPC_URL
```

### åœºæ™¯ 3: è§‚å¯Ÿè‡ªåŠ¨æ¸…ç®— (Auto-Liquidation)

**å›åˆ°æµè§ˆå™¨ (Frontend)**:
1.  **ç¬é—´å˜çº¢**: ä½ ä¼šçœ‹åˆ° Dashboard ä¸Šçš„ ETH Price å˜æˆäº† **$700**ã€‚
2.  **Health Danger**: å› ä¸º 10 ETH * $700 = $7000ï¼Œå€ºåŠ¡ $5000ã€‚æŠµæŠ¼ç‡ = 140% (< 150%)ã€‚çŠ¶æ€å˜ä¸º **Danger**ã€‚

**è§‚å¯Ÿç»ˆç«¯ B (Backend)**:
3.  **Keeper è§¦å‘**: ä½ ä¼šåœ¨ backend çš„æ—¥å¿—ä¸­çœ‹åˆ°ï¼š
    *   `keeper liquidation attempt...`
    *   `Liquidation success! owner=...`

**å›åˆ°æµè§ˆå™¨**:
4.  **èµ„äº§å˜åŒ–**: å‡ ç§’ååˆ·æ–°é¡µé¢ï¼Œä½ ä¼šå‘ç°ï¼š
    *   `Debt` å‡å°‘äº† (çº¦ä¸º $2500ï¼Œè¢«æ¸…ç®—äº†ä¸€åŠ)ã€‚
    *   `Collateral` å‡å°‘äº† (è¢«æ‹å–æŠµå€º)ã€‚
    *   `Health Factor` å˜å›äº† **Safe** (æˆ– Warning)ï¼Œç³»ç»Ÿæ¢å¤å¥åº·ã€‚
    *   åœ¨ "History" æˆ–é€šçŸ¥æ ä¸­çœ‹åˆ° "Liquidated" äº‹ä»¶ã€‚

---

## ğŸ“ æ¼”ç¤ºç»“æŸæ¢å¤

å¦‚æœæƒ³é‡ç½®ç¯å¢ƒè¿›è¡Œä¸‹ä¸€æ¬¡æ¼”ç¤ºï¼š
1.  åœ¨ Terminal A æŒ‰ `Ctrl+C` åœæ­¢ Anvilã€‚
2.  é‡æ–°è¿è¡Œ `./scripts/dev_bootstrap.sh`ã€‚
